<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Data Analysis: First Steps | Data Handling Pocket Reference</title>
  <meta name="description" content="A guide to practical data handling with a focus on R and data analytics in economics and the social sciences." />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Data Analysis: First Steps | Data Handling Pocket Reference" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://umatter.github.io/datahandling/img/cover.png" />
  <meta property="og:description" content="A guide to practical data handling with a focus on R and data analytics in economics and the social sciences." />
  <meta name="github-repo" content="umatter/datahandling" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Data Analysis: First Steps | Data Handling Pocket Reference" />
  
  <meta name="twitter:description" content="A guide to practical data handling with a focus on R and data analytics in economics and the social sciences." />
  <meta name="twitter:image" content="https://umatter.github.io/datahandling/img/cover.png" />

<meta name="author" content="Ulrich Matter" />


<meta name="date" content="2022-09-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-preparation.html"/>
<link rel="next" href="basic-econometrics-in-r.html"/>
<script src="libs/jquery/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Handling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#prerequisites-and-aims"><i class="fa fa-check"></i>Prerequisites and aims</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="programming-with-data.html"><a href="programming-with-data.html"><i class="fa fa-check"></i><b>2</b> Programming with Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="programming-with-data.html"><a href="programming-with-data.html#handling-data-programmatically"><i class="fa fa-check"></i><b>2.1</b> Handling data programmatically</a></li>
<li class="chapter" data-level="2.2" data-path="programming-with-data.html"><a href="programming-with-data.html#why-r"><i class="fa fa-check"></i><b>2.2</b> Why <em>R</em>?</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="programming-with-data.html"><a href="programming-with-data.html#the-data-language"><i class="fa fa-check"></i><b>2.2.1</b> The ‘data language’</a></li>
<li class="chapter" data-level="2.2.2" data-path="programming-with-data.html"><a href="programming-with-data.html#high-level-language-relatively-easy-to-learn"><i class="fa fa-check"></i><b>2.2.2</b> High-level language, relatively easy to learn</a></li>
<li class="chapter" data-level="2.2.3" data-path="programming-with-data.html"><a href="programming-with-data.html#free-open-source-large-community"><i class="fa fa-check"></i><b>2.2.3</b> Free, open source, large community</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="programming-with-data.html"><a href="programming-with-data.html#rrstudio-overview"><i class="fa fa-check"></i><b>2.3</b> <em>R</em>/RStudio overview</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="programming-with-data.html"><a href="programming-with-data.html#the-r-console"><i class="fa fa-check"></i><b>2.3.1</b> The <em>R</em>-Console</a></li>
<li class="chapter" data-level="2.3.2" data-path="programming-with-data.html"><a href="programming-with-data.html#r-scripts"><i class="fa fa-check"></i><b>2.3.2</b> <em>R</em>-Scripts</a></li>
<li class="chapter" data-level="2.3.3" data-path="programming-with-data.html"><a href="programming-with-data.html#r-environment"><i class="fa fa-check"></i><b>2.3.3</b> <em>R</em> Environment</a></li>
<li class="chapter" data-level="2.3.4" data-path="programming-with-data.html"><a href="programming-with-data.html#file-browser"><i class="fa fa-check"></i><b>2.3.4</b> File Browser</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="programming-with-data.html"><a href="programming-with-data.html#first-steps-with-r"><i class="fa fa-check"></i><b>2.4</b> First steps with R</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="programming-with-data.html"><a href="programming-with-data.html#values-vectors-and-variables"><i class="fa fa-check"></i><b>2.4.1</b> Values, Vectors, and Variables</a></li>
<li class="chapter" data-level="2.4.2" data-path="programming-with-data.html"><a href="programming-with-data.html#math-operators"><i class="fa fa-check"></i><b>2.4.2</b> Math operators</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="programming-with-data.html"><a href="programming-with-data.html#basic-programming-concepts-in-r"><i class="fa fa-check"></i><b>2.5</b> Basic programming concepts in R</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="programming-with-data.html"><a href="programming-with-data.html#loops"><i class="fa fa-check"></i><b>2.5.1</b> Loops</a></li>
<li class="chapter" data-level="2.5.2" data-path="programming-with-data.html"><a href="programming-with-data.html#for-loops"><i class="fa fa-check"></i><b>2.5.2</b> For-loops</a></li>
<li class="chapter" data-level="2.5.3" data-path="programming-with-data.html"><a href="programming-with-data.html#booleans-and-logical-statements"><i class="fa fa-check"></i><b>2.5.3</b> Booleans and logical statements</a></li>
<li class="chapter" data-level="2.5.4" data-path="programming-with-data.html"><a href="programming-with-data.html#r-functions"><i class="fa fa-check"></i><b>2.5.4</b> R functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>3</b> Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data.html"><a href="data.html#processing-data-simple-calculations-in-numeral-systems"><i class="fa fa-check"></i><b>3.1</b> Processing data: simple calculations in numeral systems</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data.html"><a href="data.html#the-binary-system"><i class="fa fa-check"></i><b>3.1.1</b> The binary system</a></li>
<li class="chapter" data-level="3.1.2" data-path="data.html"><a href="data.html#the-hexadecimal-system"><i class="fa fa-check"></i><b>3.1.2</b> The hexadecimal system</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data.html"><a href="data.html#character-encoding"><i class="fa fa-check"></i><b>3.2</b> Character encoding</a></li>
<li class="chapter" data-level="3.3" data-path="data.html"><a href="data.html#computer-code-and-text-files"><i class="fa fa-check"></i><b>3.3</b> Computer code and text files</a></li>
<li class="chapter" data-level="3.4" data-path="data.html"><a href="data.html#data-processing-basics"><i class="fa fa-check"></i><b>3.4</b> Data processing basics</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data.html"><a href="data.html#components-of-a-standard-computing-environment"><i class="fa fa-check"></i><b>3.4.1</b> Components of a standard computing environment</a></li>
<li class="chapter" data-level="3.4.2" data-path="data.html"><a href="data.html#illustration"><i class="fa fa-check"></i><b>3.4.2</b> Illustration</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-storage-and-data-structures.html"><a href="data-storage-and-data-structures.html"><i class="fa fa-check"></i><b>4</b> Data Storage and Data Structures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-storage-and-data-structures.html"><a href="data-storage-and-data-structures.html#unstructured-data-in-text-files"><i class="fa fa-check"></i><b>4.1</b> Unstructured data in text files</a></li>
<li class="chapter" data-level="4.2" data-path="data-storage-and-data-structures.html"><a href="data-storage-and-data-structures.html#structured-data-formats"><i class="fa fa-check"></i><b>4.2</b> Structured data formats</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="data-storage-and-data-structures.html"><a href="data-storage-and-data-structures.html#csvs-and-fixed-width-format"><i class="fa fa-check"></i><b>4.2.1</b> CSVs and fixed-width format</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data-storage-and-data-structures.html"><a href="data-storage-and-data-structures.html#units-of-informationdata-storage"><i class="fa fa-check"></i><b>4.3</b> Units of information/data storage</a></li>
<li class="chapter" data-level="4.4" data-path="data-storage-and-data-structures.html"><a href="data-storage-and-data-structures.html#data-structures-and-data-types-in-r"><i class="fa fa-check"></i><b>4.4</b> Data structures and data types in R</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="data-storage-and-data-structures.html"><a href="data-storage-and-data-structures.html#data-types"><i class="fa fa-check"></i><b>4.4.1</b> Data types</a></li>
<li class="chapter" data-level="4.4.2" data-path="data-storage-and-data-structures.html"><a href="data-storage-and-data-structures.html#data-structures"><i class="fa fa-check"></i><b>4.4.2</b> Data structures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="high-dimensional-data.html"><a href="high-dimensional-data.html"><i class="fa fa-check"></i><b>5</b> High-Dimensional Data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="high-dimensional-data.html"><a href="high-dimensional-data.html#deciphering-xml"><i class="fa fa-check"></i><b>5.1</b> Deciphering XML</a></li>
<li class="chapter" data-level="5.2" data-path="high-dimensional-data.html"><a href="high-dimensional-data.html#deciphering-json"><i class="fa fa-check"></i><b>5.2</b> Deciphering JSON</a></li>
<li class="chapter" data-level="5.3" data-path="high-dimensional-data.html"><a href="high-dimensional-data.html#parsing-xml-and-json-in-r"><i class="fa fa-check"></i><b>5.3</b> Parsing XML and JSON in R</a></li>
<li class="chapter" data-level="5.4" data-path="high-dimensional-data.html"><a href="high-dimensional-data.html#html"><i class="fa fa-check"></i><b>5.4</b> HTML</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="high-dimensional-data.html"><a href="high-dimensional-data.html#write-a-simple-webpage-with-html"><i class="fa fa-check"></i><b>5.4.1</b> Write a simple webpage with HTML</a></li>
<li class="chapter" data-level="5.4.2" data-path="high-dimensional-data.html"><a href="high-dimensional-data.html#two-ways-to-read-a-webpage-into-r"><i class="fa fa-check"></i><b>5.4.2</b> Two ways to read a webpage into R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="text-data.html"><a href="text-data.html"><i class="fa fa-check"></i><b>6</b> Text Data</a></li>
<li class="chapter" data-level="7" data-path="image-data.html"><a href="image-data.html"><i class="fa fa-check"></i><b>7</b> Image data</a>
<ul>
<li class="chapter" data-level="7.1" data-path="image-data.html"><a href="image-data.html#image-data-structure-and-storage"><i class="fa fa-check"></i><b>7.1</b> Image data structure and storage</a></li>
<li class="chapter" data-level="7.2" data-path="image-data.html"><a href="image-data.html#raster-images-in-r"><i class="fa fa-check"></i><b>7.2</b> Raster images in R</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="image-data.html"><a href="image-data.html#basic-data-structure"><i class="fa fa-check"></i><b>7.2.1</b> Basic data structure</a></li>
<li class="chapter" data-level="7.2.2" data-path="image-data.html"><a href="image-data.html#advanced-image-manipulation-using-imagemagick"><i class="fa fa-check"></i><b>7.2.2</b> Advanced Image Manipulation using ImageMagick</a></li>
<li class="chapter" data-level="7.2.3" data-path="image-data.html"><a href="image-data.html#working-with-ocr-optical-character-recognition"><i class="fa fa-check"></i><b>7.2.3</b> Working with OCR (Optical Character Recognition)</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="image-data.html"><a href="image-data.html#vector-images-in-r"><i class="fa fa-check"></i><b>7.3</b> Vector Images in R</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="image-data.html"><a href="image-data.html#example-maps"><i class="fa fa-check"></i><b>7.3.1</b> Example: Maps</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-sources-data-gathering-data-import.html"><a href="data-sources-data-gathering-data-import.html"><i class="fa fa-check"></i><b>8</b> Data Sources, Data Gathering, Data Import</a>
<ul>
<li class="chapter" data-level="8.1" data-path="data-sources-data-gathering-data-import.html"><a href="data-sources-data-gathering-data-import.html#sourcesformats"><i class="fa fa-check"></i><b>8.1</b> Sources/formats</a></li>
<li class="chapter" data-level="8.2" data-path="data-sources-data-gathering-data-import.html"><a href="data-sources-data-gathering-data-import.html#data-gathering-procedure"><i class="fa fa-check"></i><b>8.2</b> Data gathering procedure</a></li>
<li class="chapter" data-level="8.3" data-path="data-sources-data-gathering-data-import.html"><a href="data-sources-data-gathering-data-import.html#loadingimporting-rectangular-data"><i class="fa fa-check"></i><b>8.3</b> Loading/importing rectangular data</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="data-sources-data-gathering-data-import.html"><a href="data-sources-data-gathering-data-import.html#loading-built-in-datasets"><i class="fa fa-check"></i><b>8.3.1</b> Loading built-in datasets</a></li>
<li class="chapter" data-level="8.3.2" data-path="data-sources-data-gathering-data-import.html"><a href="data-sources-data-gathering-data-import.html#importing-rectangular-data-from-text-files"><i class="fa fa-check"></i><b>8.3.2</b> Importing rectangular data from text-files</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="data-sources-data-gathering-data-import.html"><a href="data-sources-data-gathering-data-import.html#import-and-parse-with-readr"><i class="fa fa-check"></i><b>8.4</b> Import and parse with <code>readr</code></a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="data-sources-data-gathering-data-import.html"><a href="data-sources-data-gathering-data-import.html#basic-usage-of-readr-functions"><i class="fa fa-check"></i><b>8.4.1</b> Basic usage of <code>readr</code> functions</a></li>
<li class="chapter" data-level="8.4.2" data-path="data-sources-data-gathering-data-import.html"><a href="data-sources-data-gathering-data-import.html#parsing-and-data-types"><i class="fa fa-check"></i><b>8.4.2</b> Parsing and data types</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="data-sources-data-gathering-data-import.html"><a href="data-sources-data-gathering-data-import.html#importing-web-data-formats"><i class="fa fa-check"></i><b>8.5</b> Importing web data formats</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="data-sources-data-gathering-data-import.html"><a href="data-sources-data-gathering-data-import.html#xml-in-r"><i class="fa fa-check"></i><b>8.5.1</b> XML in R</a></li>
<li class="chapter" data-level="8.5.2" data-path="data-sources-data-gathering-data-import.html"><a href="data-sources-data-gathering-data-import.html#json-in-r"><i class="fa fa-check"></i><b>8.5.2</b> JSON in R</a></li>
<li class="chapter" data-level="8.5.3" data-path="data-sources-data-gathering-data-import.html"><a href="data-sources-data-gathering-data-import.html#tutorial-advanced-importing-data-from-a-html-table-on-a-website"><i class="fa fa-check"></i><b>8.5.3</b> Tutorial (advanced): Importing data from a HTML table (on a website)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data-preparation.html"><a href="data-preparation.html"><i class="fa fa-check"></i><b>9</b> Data Preparation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="data-preparation.html"><a href="data-preparation.html#cleaning-data-with-basic-string-operations"><i class="fa fa-check"></i><b>9.1</b> Cleaning data with basic string operations</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="data-preparation.html"><a href="data-preparation.html#findreplace-character-strings-recode-factor-levels"><i class="fa fa-check"></i><b>9.1.1</b> Find/replace character strings, recode factor levels</a></li>
<li class="chapter" data-level="9.1.2" data-path="data-preparation.html"><a href="data-preparation.html#removing-individual-characters-from-a-string"><i class="fa fa-check"></i><b>9.1.2</b> Removing individual characters from a string</a></li>
<li class="chapter" data-level="9.1.3" data-path="data-preparation.html"><a href="data-preparation.html#splitting-strings"><i class="fa fa-check"></i><b>9.1.3</b> Splitting strings</a></li>
<li class="chapter" data-level="9.1.4" data-path="data-preparation.html"><a href="data-preparation.html#parsing-dates"><i class="fa fa-check"></i><b>9.1.4</b> Parsing dates</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="data-preparation.html"><a href="data-preparation.html#reshaping-datasets"><i class="fa fa-check"></i><b>9.2</b> Reshaping datasets</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="data-preparation.html"><a href="data-preparation.html#tidying-messy-datasets."><i class="fa fa-check"></i><b>9.2.1</b> Tidying messy datasets.</a></li>
<li class="chapter" data-level="9.2.2" data-path="data-preparation.html"><a href="data-preparation.html#pivoting-from-wide-to-long-gathering"><i class="fa fa-check"></i><b>9.2.2</b> Pivoting from ‘wide to long’ (“gathering”)</a></li>
<li class="chapter" data-level="9.2.3" data-path="data-preparation.html"><a href="data-preparation.html#pivoting-from-long-to-wide-spreading"><i class="fa fa-check"></i><b>9.2.3</b> Pivoting from ‘long to wide’ (“spreading”)</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="data-preparation.html"><a href="data-preparation.html#tutorial-hotel-bookings-time-series"><i class="fa fa-check"></i><b>9.3</b> Tutorial: Hotel Bookings Time Series</a></li>
<li class="chapter" data-level="9.4" data-path="data-preparation.html"><a href="data-preparation.html#set-up-and-import"><i class="fa fa-check"></i><b>9.4</b> Set up and import</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="data-analysis-first-steps.html"><a href="data-analysis-first-steps.html"><i class="fa fa-check"></i><b>10</b> Data Analysis: First Steps</a>
<ul>
<li class="chapter" data-level="10.1" data-path="data-analysis-first-steps.html"><a href="data-analysis-first-steps.html#merging-datasets"><i class="fa fa-check"></i><b>10.1</b> Merging datasets</a></li>
<li class="chapter" data-level="10.2" data-path="data-analysis-first-steps.html"><a href="data-analysis-first-steps.html#selecting-subsets"><i class="fa fa-check"></i><b>10.2</b> Selecting subsets</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="data-analysis-first-steps.html"><a href="data-analysis-first-steps.html#filtering-datasets"><i class="fa fa-check"></i><b>10.2.1</b> Filtering datasets</a></li>
<li class="chapter" data-level="10.2.2" data-path="data-analysis-first-steps.html"><a href="data-analysis-first-steps.html#mutating-datasets"><i class="fa fa-check"></i><b>10.2.2</b> Mutating datasets</a></li>
<li class="chapter" data-level="10.2.3" data-path="data-analysis-first-steps.html"><a href="data-analysis-first-steps.html#aggregation-and-summary-statistics"><i class="fa fa-check"></i><b>10.2.3</b> Aggregation and summary statistics</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="data-analysis-first-steps.html"><a href="data-analysis-first-steps.html#tutorial-analise-messy-excel-sheets"><i class="fa fa-check"></i><b>10.3</b> Tutorial: Analise messy Excel sheets</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="data-analysis-first-steps.html"><a href="data-analysis-first-steps.html#preparatory-steps"><i class="fa fa-check"></i><b>10.3.1</b> Preparatory steps</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="basic-econometrics-in-r.html"><a href="basic-econometrics-in-r.html"><i class="fa fa-check"></i><b>11</b> Basic Econometrics in R</a>
<ul>
<li class="chapter" data-level="11.1" data-path="basic-econometrics-in-r.html"><a href="basic-econometrics-in-r.html#statistical-modeling"><i class="fa fa-check"></i><b>11.1</b> Statistical modeling</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="basic-econometrics-in-r.html"><a href="basic-econometrics-in-r.html#illustration-with-pseudo-data"><i class="fa fa-check"></i><b>11.1.1</b> Illustration with pseudo-data</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="basic-econometrics-in-r.html"><a href="basic-econometrics-in-r.html#estimation-and-application"><i class="fa fa-check"></i><b>11.2</b> Estimation and Application</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="basic-econometrics-in-r.html"><a href="basic-econometrics-in-r.html#model-specification"><i class="fa fa-check"></i><b>11.2.1</b> Model specification</a></li>
<li class="chapter" data-level="11.2.2" data-path="basic-econometrics-in-r.html"><a href="basic-econometrics-in-r.html#raw-data"><i class="fa fa-check"></i><b>11.2.2</b> Raw data</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="basic-econometrics-in-r.html"><a href="basic-econometrics-in-r.html#derivation-and-implementation-of-ols-estimator"><i class="fa fa-check"></i><b>11.3</b> Derivation and implementation of OLS estimator</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="basic-econometrics-in-r.html"><a href="basic-econometrics-in-r.html#regression-toolbox-in-r"><i class="fa fa-check"></i><b>11.3.1</b> Regression toolbox in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="data-visualization.html"><a href="data-visualization.html"><i class="fa fa-check"></i><b>12</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="12.1" data-path="data-visualization.html"><a href="data-visualization.html#data-display"><i class="fa fa-check"></i><b>12.1</b> Data display</a></li>
<li class="chapter" data-level="12.2" data-path="data-visualization.html"><a href="data-visualization.html#data-visualization-with-ggplot2"><i class="fa fa-check"></i><b>12.2</b> Data visualization with <code>ggplot2</code></a></li>
<li class="chapter" data-level="12.3" data-path="data-visualization.html"><a href="data-visualization.html#grammar-of-graphics"><i class="fa fa-check"></i><b>12.3</b> ‘Grammar of Graphics’</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="data-visualization.html"><a href="data-visualization.html#ggplot2-basics"><i class="fa fa-check"></i><b>12.3.1</b> <code>ggplot2</code> basics</a></li>
<li class="chapter" data-level="12.3.2" data-path="data-visualization.html"><a href="data-visualization.html#tutorial"><i class="fa fa-check"></i><b>12.3.2</b> Tutorial</a></li>
<li class="chapter" data-level="12.3.3" data-path="data-visualization.html"><a href="data-visualization.html#loadingpreparing-the-data"><i class="fa fa-check"></i><b>12.3.3</b> Loading/preparing the data</a></li>
<li class="chapter" data-level="12.3.4" data-path="data-visualization.html"><a href="data-visualization.html#geometries-type-of-plot"><i class="fa fa-check"></i><b>12.3.4</b> Geometries (~ type of plot)</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="data-visualization.html"><a href="data-visualization.html#dynamic-documents"><i class="fa fa-check"></i><b>12.4</b> Dynamic documents</a></li>
<li class="chapter" data-level="12.5" data-path="data-visualization.html"><a href="data-visualization.html#tutorial-how-to-give-the-wrong-impression-with-data-visualization"><i class="fa fa-check"></i><b>12.5</b> Tutorial: How to give the wrong impression with data visualization</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="data-visualization.html"><a href="data-visualization.html#background-and-aim"><i class="fa fa-check"></i><b>12.5.1</b> Background and aim</a></li>
<li class="chapter" data-level="12.5.2" data-path="data-visualization.html"><a href="data-visualization.html#data-import-and-preparation"><i class="fa fa-check"></i><b>12.5.2</b> Data import and preparation</a></li>
<li class="chapter" data-level="12.5.3" data-path="data-visualization.html"><a href="data-visualization.html#plot"><i class="fa fa-check"></i><b>12.5.3</b> Plot</a></li>
<li class="chapter" data-level="12.5.4" data-path="data-visualization.html"><a href="data-visualization.html#cosmetics-theme"><i class="fa fa-check"></i><b>12.5.4</b> Cosmetics: theme</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="appendix-a.html"><a href="appendix-a.html"><i class="fa fa-check"></i><b>A</b> Appendix A</a>
<ul>
<li class="chapter" data-level="A.1" data-path="appendix-a.html"><a href="appendix-a.html#understanding-statistics-and-probability-with-code"><i class="fa fa-check"></i><b>A.1</b> Understanding statistics and probability with code</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="appendix-a.html"><a href="appendix-a.html#random-draws-and-distributions"><i class="fa fa-check"></i><b>A.1.1</b> Random draws and distributions</a></li>
<li class="chapter" data-level="A.1.2" data-path="appendix-a.html"><a href="appendix-a.html#illustration-of-variability"><i class="fa fa-check"></i><b>A.1.2</b> Illustration of variability</a></li>
<li class="chapter" data-level="A.1.3" data-path="appendix-a.html"><a href="appendix-a.html#skewness-and-kurtosis"><i class="fa fa-check"></i><b>A.1.3</b> Skewness and Kurtosis</a></li>
<li class="chapter" data-level="A.1.4" data-path="appendix-a.html"><a href="appendix-a.html#the-law-of-large-numbers"><i class="fa fa-check"></i><b>A.1.4</b> The Law of Large Numbers</a></li>
<li class="chapter" data-level="A.1.5" data-path="appendix-a.html"><a href="appendix-a.html#the-central-limit-theorem"><i class="fa fa-check"></i><b>A.1.5</b> The Central Limit Theorem</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://umatter.github.io" target="blank">umatter.github.io</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Handling Pocket Reference</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-analysis-first-steps" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Chapter 10</span> Data Analysis: First Steps<a href="data-analysis-first-steps.html#data-analysis-first-steps" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In the first part of this chapter, we look at some key functions for applied data analysis in R. At this point, we have already implemented collecting/importing and cleaning the raw data. The analysis part can be thought of as a collection of tasks with the aim of making sense of the data. In practice, this can be explorative (discovering interesting patterns in the data) or inductive (testing of a specific hypothesis). Moreover, it typically involves functions for actual statistical analysis and various functions to select, combine, filter, and aggregate data. Similar to the topic of data cleaning/preparation, covering all aspects of applied data analysis with R goes well beyond the scope of one chapter. The aim is thus to give a practical overview of some of the basic concepts and their corresponding R functions (here from <code>tidyverse</code>).</p>
<div id="merging-datasets" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Merging datasets<a href="data-analysis-first-steps.html#merging-datasets" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The following two data sets contain data on persons’ characteristics and their consumption spending. Both are cleaned datasets. But, for analysis purposes, we have to combine the two datasets. There are several ways to do this in R, but most commonly (for <code>data.frames</code> as well as <code>tibbles</code>), we can use the <code>merge()</code>-function.</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="data-analysis-first-steps.html#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb311-2"><a href="data-analysis-first-steps.html#cb311-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb311-3"><a href="data-analysis-first-steps.html#cb311-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-4"><a href="data-analysis-first-steps.html#cb311-4" aria-hidden="true" tabindex="-1"></a><span class="co"># initiate data frame on persons&#39; spending</span></span>
<span id="cb311-5"><a href="data-analysis-first-steps.html#cb311-5" aria-hidden="true" tabindex="-1"></a>df_c <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>),</span>
<span id="cb311-6"><a href="data-analysis-first-steps.html#cb311-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">money_spent=</span> <span class="fu">c</span>(<span class="dv">1000</span>, <span class="dv">2000</span>, <span class="dv">6000</span>, <span class="dv">1500</span>, <span class="dv">3000</span>, <span class="dv">5500</span>),</span>
<span id="cb311-7"><a href="data-analysis-first-steps.html#cb311-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">currency =</span> <span class="fu">c</span>(<span class="st">&quot;CHF&quot;</span>, <span class="st">&quot;CHF&quot;</span>, <span class="st">&quot;USD&quot;</span>, <span class="st">&quot;EUR&quot;</span>, <span class="st">&quot;CHF&quot;</span>, <span class="st">&quot;USD&quot;</span>),</span>
<span id="cb311-8"><a href="data-analysis-first-steps.html#cb311-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">year=</span><span class="fu">c</span>(<span class="dv">2017</span>,<span class="dv">2017</span>,<span class="dv">2017</span>,<span class="dv">2018</span>,<span class="dv">2018</span>,<span class="dv">2018</span>))</span>
<span id="cb311-9"><a href="data-analysis-first-steps.html#cb311-9" aria-hidden="true" tabindex="-1"></a>df_c</span></code></pre></div>
<pre><code>##   id money_spent currency year
## 1  1        1000      CHF 2017
## 2  2        2000      CHF 2017
## 3  3        6000      USD 2017
## 4  1        1500      EUR 2018
## 5  2        3000      CHF 2018
## 6  3        5500      USD 2018</code></pre>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="data-analysis-first-steps.html#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="co"># initiate data frame on persons&#39; characteristics</span></span>
<span id="cb313-2"><a href="data-analysis-first-steps.html#cb313-2" aria-hidden="true" tabindex="-1"></a>df_p <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb313-3"><a href="data-analysis-first-steps.html#cb313-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">first_name =</span> <span class="fu">c</span>(<span class="st">&quot;Anna&quot;</span>, <span class="st">&quot;Betty&quot;</span>, <span class="st">&quot;Claire&quot;</span>, <span class="st">&quot;Diane&quot;</span>),</span>
<span id="cb313-4"><a href="data-analysis-first-steps.html#cb313-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">profession =</span> <span class="fu">c</span>(<span class="st">&quot;Economist&quot;</span>, <span class="st">&quot;Data Scientist&quot;</span>,</span>
<span id="cb313-5"><a href="data-analysis-first-steps.html#cb313-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;Data Scientist&quot;</span>, <span class="st">&quot;Economist&quot;</span>))</span>
<span id="cb313-6"><a href="data-analysis-first-steps.html#cb313-6" aria-hidden="true" tabindex="-1"></a>df_p</span></code></pre></div>
<pre><code>##   id first_name     profession
## 1  1       Anna      Economist
## 2  2      Betty Data Scientist
## 3  3     Claire Data Scientist
## 4  4      Diane      Economist</code></pre>
<p>Our aim is to compute the average spending by profession. Therefore, we want to link <code>money_spent</code> with <code>profession</code>. Both datasets contain a unique identifier <code>id</code>, which we can use to link the observations via <code>merge()</code>.</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="data-analysis-first-steps.html#cb315-1" aria-hidden="true" tabindex="-1"></a>df_merged <span class="ot">&lt;-</span> <span class="fu">merge</span>(df_p, df_c, <span class="at">by=</span><span class="st">&quot;id&quot;</span>)</span>
<span id="cb315-2"><a href="data-analysis-first-steps.html#cb315-2" aria-hidden="true" tabindex="-1"></a>df_merged</span></code></pre></div>
<pre><code>##   id first_name     profession money_spent currency
## 1  1       Anna      Economist        1000      CHF
## 2  1       Anna      Economist        1500      EUR
## 3  2      Betty Data Scientist        2000      CHF
## 4  2      Betty Data Scientist        3000      CHF
## 5  3     Claire Data Scientist        6000      USD
## 6  3     Claire Data Scientist        5500      USD
##   year
## 1 2017
## 2 2018
## 3 2017
## 4 2018
## 5 2017
## 6 2018</code></pre>
<p>Note how only the exact matches are merged. The observation of <code>"Diane"</code> is not part of the merged data frame because there is no corresponding row in <code>df_c</code> with her spending information. If for some reason, we would like to have all persons in the merged dataset, we can specify the <code>merge()</code>-call accordingly:</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="data-analysis-first-steps.html#cb317-1" aria-hidden="true" tabindex="-1"></a>df_merged2 <span class="ot">&lt;-</span> <span class="fu">merge</span>(df_p, df_c, <span class="at">by=</span><span class="st">&quot;id&quot;</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb317-2"><a href="data-analysis-first-steps.html#cb317-2" aria-hidden="true" tabindex="-1"></a>df_merged2</span></code></pre></div>
<pre><code>##   id first_name     profession money_spent currency
## 1  1       Anna      Economist        1000      CHF
## 2  1       Anna      Economist        1500      EUR
## 3  2      Betty Data Scientist        2000      CHF
## 4  2      Betty Data Scientist        3000      CHF
## 5  3     Claire Data Scientist        6000      USD
## 6  3     Claire Data Scientist        5500      USD
## 7  4      Diane      Economist          NA     &lt;NA&gt;
##   year
## 1 2017
## 2 2018
## 3 2017
## 4 2018
## 5 2017
## 6 2018
## 7   NA</code></pre>
</div>
<div id="selecting-subsets" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Selecting subsets<a href="data-analysis-first-steps.html#selecting-subsets" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For our analysis’s next steps, we do not need to have all columns. Via the <code>select()</code>-function provided in <code>tidyverse</code> we can easily select the columns of interest</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="data-analysis-first-steps.html#cb319-1" aria-hidden="true" tabindex="-1"></a>df_selection <span class="ot">&lt;-</span> <span class="fu">select</span>(df_merged, id, year, money_spent, currency)</span>
<span id="cb319-2"><a href="data-analysis-first-steps.html#cb319-2" aria-hidden="true" tabindex="-1"></a>df_selection</span></code></pre></div>
<pre><code>##   id year money_spent currency
## 1  1 2017        1000      CHF
## 2  1 2018        1500      EUR
## 3  2 2017        2000      CHF
## 4  2 2018        3000      CHF
## 5  3 2017        6000      USD
## 6  3 2018        5500      USD</code></pre>
<div id="filtering-datasets" class="section level3 hasAnchor" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Filtering datasets<a href="data-analysis-first-steps.html#filtering-datasets" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the next step, we want to select only observations with specific characteristics. Say we want to select only observations from 2018. Again there are several ways to do this in R, but the most comfortable way is to use the <code>filter()</code> function provided in <code>tidyverse</code>.</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="data-analysis-first-steps.html#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(df_selection, year <span class="sc">==</span> <span class="dv">2018</span>)</span></code></pre></div>
<pre><code>##   id year money_spent currency
## 1  1 2018        1500      EUR
## 2  2 2018        3000      CHF
## 3  3 2018        5500      USD</code></pre>
<p>We can use several filtering conditions simultaneously:</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="data-analysis-first-steps.html#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(df_selection, year <span class="sc">==</span> <span class="dv">2018</span>, money_spent <span class="sc">&lt;</span> <span class="dv">5000</span>, currency<span class="sc">==</span><span class="st">&quot;EUR&quot;</span>)</span></code></pre></div>
<pre><code>##   id year money_spent currency
## 1  1 2018        1500      EUR</code></pre>
</div>
<div id="mutating-datasets" class="section level3 hasAnchor" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> Mutating datasets<a href="data-analysis-first-steps.html#mutating-datasets" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before we compute aggregate statistics based on our selected dataset, we have to deal with the fact that the <code>money_spent</code>-variable is not tidy. It describes each observation’s characteristic, but it is measured in different units (here, different currencies) across some of these observations. If the aim was to have a perfectly tidy dataset, we could address the issue with <code>spread()</code>. However, in this context, it could be more helpful to add an additional variable/column with a normalized amount of money spent. That is, we want to have every value converted to one currency (given a certain exchange rate). In order to do so, we use the <code>mutate()</code> function (again provided in <code>tidyverse</code>).</p>
<p>First, we look up the USD/CHF and EUR/CHF exchange rates and add those as a variable (CHF/CHF exchange rates are equal to 1, of course).</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="data-analysis-first-steps.html#cb325-1" aria-hidden="true" tabindex="-1"></a>exchange_rates <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">exchange_rate=</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="dv">1</span>, <span class="fl">1.2</span>),</span>
<span id="cb325-2"><a href="data-analysis-first-steps.html#cb325-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">currency=</span><span class="fu">c</span>(<span class="st">&quot;USD&quot;</span>, <span class="st">&quot;CHF&quot;</span>, <span class="st">&quot;EUR&quot;</span>), <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb325-3"><a href="data-analysis-first-steps.html#cb325-3" aria-hidden="true" tabindex="-1"></a>df_selection <span class="ot">&lt;-</span> <span class="fu">merge</span>(df_selection, exchange_rates, <span class="at">by=</span><span class="st">&quot;currency&quot;</span>)</span></code></pre></div>
<p>Now we can define an additional variable with the money spent in CHF via <code>mutate()</code>:</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="data-analysis-first-steps.html#cb326-1" aria-hidden="true" tabindex="-1"></a>df_mutated <span class="ot">&lt;-</span> <span class="fu">mutate</span>(df_selection, <span class="at">money_spent_chf =</span> money_spent <span class="sc">*</span> exchange_rate)</span>
<span id="cb326-2"><a href="data-analysis-first-steps.html#cb326-2" aria-hidden="true" tabindex="-1"></a>df_mutated</span></code></pre></div>
<pre><code>##   currency id year money_spent exchange_rate
## 1      CHF  1 2017        1000           1.0
## 2      CHF  2 2017        2000           1.0
## 3      CHF  2 2018        3000           1.0
## 4      EUR  1 2018        1500           1.2
## 5      USD  3 2017        6000           0.9
## 6      USD  3 2018        5500           0.9
##   money_spent_chf
## 1            1000
## 2            2000
## 3            3000
## 4            1800
## 5            5400
## 6            4950</code></pre>
</div>
<div id="aggregation-and-summary-statistics" class="section level3 hasAnchor" number="10.2.3">
<h3><span class="header-section-number">10.2.3</span> Aggregation and summary statistics<a href="data-analysis-first-steps.html#aggregation-and-summary-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now we can start analyzing the dataset. Typically, the first step of analyzing a dataset is to get an overview by computing some summary statistics. This helps to better understand the dataset at hand. Key summary statistics of the variables of interest are the mean, standard deviation, median, and a number of observations. Together, they give a first idea of how the variables of interest are distributed.</p>
<p>As you know from previous chapters, R has several built-in functions that help us do this. In practice, these basic functions are often combined with functions implemented particularly for this step of the analysis, such as <code>summarise()</code> provided in <code>tidyverse</code>.</p>
<p>As the first output in our report, we want to show the key characteristics of the spending data in one table.</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="data-analysis-first-steps.html#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(df_mutated,</span>
<span id="cb328-2"><a href="data-analysis-first-steps.html#cb328-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">mean =</span> <span class="fu">mean</span>(money_spent_chf),</span>
<span id="cb328-3"><a href="data-analysis-first-steps.html#cb328-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">standard_deviation =</span> <span class="fu">sd</span>(money_spent_chf),</span>
<span id="cb328-4"><a href="data-analysis-first-steps.html#cb328-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">median =</span> <span class="fu">median</span>(money_spent_chf),</span>
<span id="cb328-5"><a href="data-analysis-first-steps.html#cb328-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">N =</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code>##   mean standard_deviation median N
## 1 3025               1789   2500 6</code></pre>
<p>Moreover, we can compute the same statistics grouped by certain observation characteristics. For example, we can compute the same summary statistics per year of observation.</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="data-analysis-first-steps.html#cb330-1" aria-hidden="true" tabindex="-1"></a>by_year <span class="ot">&lt;-</span> <span class="fu">group_by</span>(df_mutated, year)</span>
<span id="cb330-2"><a href="data-analysis-first-steps.html#cb330-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(by_year,</span>
<span id="cb330-3"><a href="data-analysis-first-steps.html#cb330-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">mean =</span> <span class="fu">mean</span>(money_spent_chf),</span>
<span id="cb330-4"><a href="data-analysis-first-steps.html#cb330-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">standard_deviation =</span> <span class="fu">sd</span>(money_spent_chf),</span>
<span id="cb330-5"><a href="data-analysis-first-steps.html#cb330-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">median =</span> <span class="fu">median</span>(money_spent_chf),</span>
<span id="cb330-6"><a href="data-analysis-first-steps.html#cb330-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">N =</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code>## # A tibble: 2 × 5
##    year  mean standard_deviation median     N
##   &lt;dbl&gt; &lt;dbl&gt;              &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;
## 1  2017  2800              2307.   2000     3
## 2  2018  3250              1590.   3000     3</code></pre>
<p>Alternatively, to the more user-friendly (but less flexible) <code>summarise</code> function, we can use lower-level functions to compute aggregate statistics provided in the basic R distribution. A good example of such a function is <code>sapply()</code>. In simple terms, <code>sapply()</code> takes a list as input and applies a function to the content of each element in this list (here: compute a statistic for each column). To illustrate this point, we load the already familiar <code>swiss</code> dataset.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="data-analysis-first-steps.html#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb332-2"><a href="data-analysis-first-steps.html#cb332-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;swiss&quot;</span>)</span></code></pre></div>
<p>Now we want to compute the mean for each variable in this dataset. Technically speaking, a data frame is a list, where each list element is a column of the same length. Thus, we can use <code>sapply()</code> to ‘apply’ the function <code>mean()</code> to each of the columns in <code>swiss</code>.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="data-analysis-first-steps.html#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(swiss, mean)</span></code></pre></div>
<pre><code>##        Fertility      Agriculture      Examination 
##            70.14            50.66            16.49 
##        Education         Catholic Infant.Mortality 
##            10.98            41.14            19.94</code></pre>
<p>By default, <code>sapply()</code> returns a vector or a matrix.<a href="#fn23" class="footnote-ref" id="fnref23"><sup>23</sup></a> We can get a similar result by using <code>summarise()</code>. However, we would have to explicitly mention which variables we want as input.</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="data-analysis-first-steps.html#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(swiss,</span>
<span id="cb335-2"><a href="data-analysis-first-steps.html#cb335-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">Fertility =</span> <span class="fu">mean</span>(Fertility),</span>
<span id="cb335-3"><a href="data-analysis-first-steps.html#cb335-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">Agriculture =</span> <span class="fu">mean</span>(Agriculture)) <span class="co"># etc.</span></span></code></pre></div>
<pre><code>##   Fertility Agriculture
## 1     70.14       50.66</code></pre>
</div>
</div>
<div id="tutorial-analise-messy-excel-sheets" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Tutorial: Analise messy Excel sheets<a href="data-analysis-first-steps.html#tutorial-analise-messy-excel-sheets" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The following tutorial is a (substantially) shortened and simplified version of Ista Zahn and Daina Bouquin’s <a href="https://rawgit.com/izahn/R-data-cleaning/master/dataCleaning.html">“Cleaning up messy data tutorial” (Harvard Datafest 2017)</a>. The tutorial aims to clean up an Excel sheet provided by the UK Office of National Statistics that provides data on the most popular baby names in England and Wales in 2015. The dataset is stored in <code>data/2015boysnamesfinal.xlsx</code></p>
<div id="preparatory-steps" class="section level3 hasAnchor" number="10.3.1">
<h3><span class="header-section-number">10.3.1</span> Preparatory steps<a href="data-analysis-first-steps.html#preparatory-steps" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="data-analysis-first-steps.html#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="do">## SET UP -------------------</span></span>
<span id="cb337-2"><a href="data-analysis-first-steps.html#cb337-2" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb337-3"><a href="data-analysis-first-steps.html#cb337-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb337-4"><a href="data-analysis-first-steps.html#cb337-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb337-5"><a href="data-analysis-first-steps.html#cb337-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-6"><a href="data-analysis-first-steps.html#cb337-6" aria-hidden="true" tabindex="-1"></a><span class="co"># fix variables</span></span>
<span id="cb337-7"><a href="data-analysis-first-steps.html#cb337-7" aria-hidden="true" tabindex="-1"></a>INPUT_PATH <span class="ot">&lt;-</span> <span class="st">&quot;data/2015boysnamesfinal.xlsx&quot;</span></span></code></pre></div>
<p>Before diving into the data import and cleaning, it is helpful to first open the file in Excel. We notice a couple of things there: first, there are several sheets in this Excel file. For this exercise, we only rely on the sheet called “Table 1”. Second, in this sheet, we notice intuitively some potential problems with importing this dataset due to the way the spreadsheet is organized. The actual data entries only start on row 7. These two issues can be considered when importing the data with <code>read_excel()</code>.</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="data-analysis-first-steps.html#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="do">## LOAD/INSPECT DATA -----------------</span></span>
<span id="cb338-2"><a href="data-analysis-first-steps.html#cb338-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-3"><a href="data-analysis-first-steps.html#cb338-3" aria-hidden="true" tabindex="-1"></a><span class="co"># import the excel sheet</span></span>
<span id="cb338-4"><a href="data-analysis-first-steps.html#cb338-4" aria-hidden="true" tabindex="-1"></a>boys <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(INPUT_PATH, <span class="at">col_names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb338-5"><a href="data-analysis-first-steps.html#cb338-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sheet =</span> <span class="st">&quot;Table 1&quot;</span>, <span class="co"># the name of the sheet to be loaded into R</span></span>
<span id="cb338-6"><a href="data-analysis-first-steps.html#cb338-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">skip =</span> <span class="dv">6</span> <span class="co"># skip the first 6 rows of the original sheet,</span></span>
<span id="cb338-7"><a href="data-analysis-first-steps.html#cb338-7" aria-hidden="true" tabindex="-1"></a>                   )</span></code></pre></div>
<pre><code>## New names:
## • `Rank` -&gt; `Rank...1`
## • `Name` -&gt; `Name...2`
## • `Count` -&gt; `Count...3`
## • `since 2014` -&gt; `since 2014...4`
## • `since 2005` -&gt; `since 2005...5`
## • `` -&gt; `...6`
## • `Rank` -&gt; `Rank...7`
## • `Name` -&gt; `Name...8`
## • `Count` -&gt; `Count...9`
## • `since 2014` -&gt; `since 2014...10`
## • `since 2005` -&gt; `since 2005...11`</code></pre>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="data-analysis-first-steps.html#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb340-2"><a href="data-analysis-first-steps.html#cb340-2" aria-hidden="true" tabindex="-1"></a>boys</span></code></pre></div>
<pre><code>## # A tibble: 61 × 11
##    Rank...1 Name...2 Count...3 `since 2014...4`
##    &lt;chr&gt;    &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;           
##  1 &lt;NA&gt;     &lt;NA&gt;            NA &lt;NA&gt;            
##  2 1        OLIVER        6941 ­                
##  3 2        JACK          5371 ­                
##  4 3        HARRY         5308 ­                
##  5 4        GEORGE        4869 +3              
##  6 5        JACOB         4850 -1              
##  7 6        CHARLIE       4831 -1              
##  8 7        NOAH          4148 +4              
##  9 8        WILLIAM       4083 +2              
## 10 9        THOMAS        4075 -3              
## # … with 51 more rows, and 7 more variables:
## #   `since 2005...5` &lt;chr&gt;, ...6 &lt;lgl&gt;,
## #   Rank...7 &lt;chr&gt;, Name...8 &lt;chr&gt;, Count...9 &lt;dbl&gt;,
## #   `since 2014...10` &lt;chr&gt;, `since 2005...11` &lt;chr&gt;</code></pre>
<p>Note that by default, <code>read_excel()</code> “repairs” the column names of imported datasets to ensure all columns have unique names. We do not need to worry about the automatically assigned column names. However, some of the columns are not needed for analytics purposes. In addition, we note that some rows are empty (contain <code>NA</code> values). In the next step we <em>select</em> only those columns needed and <em>filter</em> incomplete observations out.</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="data-analysis-first-steps.html#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FILTER/CLEAN ---------------------------</span></span>
<span id="cb342-2"><a href="data-analysis-first-steps.html#cb342-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb342-3"><a href="data-analysis-first-steps.html#cb342-3" aria-hidden="true" tabindex="-1"></a><span class="co"># select columns</span></span>
<span id="cb342-4"><a href="data-analysis-first-steps.html#cb342-4" aria-hidden="true" tabindex="-1"></a>boys <span class="ot">&lt;-</span> <span class="fu">select</span>(boys, Rank...<span class="dv">1</span>, Name...<span class="dv">2</span>, Count...<span class="dv">3</span>, Rank...<span class="dv">7</span>, Name...<span class="dv">8</span>, Count...<span class="dv">9</span>)</span>
<span id="cb342-5"><a href="data-analysis-first-steps.html#cb342-5" aria-hidden="true" tabindex="-1"></a><span class="co"># filter rows</span></span>
<span id="cb342-6"><a href="data-analysis-first-steps.html#cb342-6" aria-hidden="true" tabindex="-1"></a>boys <span class="ot">&lt;-</span>  <span class="fu">filter</span>(boys, <span class="sc">!</span><span class="fu">is.na</span>(Rank...<span class="dv">1</span>))</span></code></pre></div>
<p>Finally, we re-arrange the data by stacking them in a three-column format.</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="data-analysis-first-steps.html#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="co"># stack columns</span></span>
<span id="cb343-2"><a href="data-analysis-first-steps.html#cb343-2" aria-hidden="true" tabindex="-1"></a>boys_long <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(boys[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], boys[,<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>])</span></code></pre></div>
<pre><code>## New names:
## New names:
## • `Rank...1` -&gt; `Rank`
## • `Name...2` -&gt; `Name`
## • `Count...3` -&gt; `Count`</code></pre>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="data-analysis-first-steps.html#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect result</span></span>
<span id="cb345-2"><a href="data-analysis-first-steps.html#cb345-2" aria-hidden="true" tabindex="-1"></a>boys_long</span></code></pre></div>
<pre><code>## # A tibble: 114 × 3
##    Rank  Name    Count
##    &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;
##  1 1     OLIVER   6941
##  2 2     JACK     5371
##  3 3     HARRY    5308
##  4 4     GEORGE   4869
##  5 5     JACOB    4850
##  6 6     CHARLIE  4831
##  7 7     NOAH     4148
##  8 8     WILLIAM  4083
##  9 9     THOMAS   4075
## 10 10    OSCAR    4066
## # … with 104 more rows</code></pre>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="23">
<li id="fn23"><p>The related function <code>lapply()</code>, returns a list (see <code>lapply(swiss, mean)</code>).<a href="data-analysis-first-steps.html#fnref23" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-preparation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="basic-econometrics-in-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 1
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["datahandling.pdf", "datahandling.html", "datahandling.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
